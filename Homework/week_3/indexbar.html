<!DOCTYPE html>
<html lang="en">
    <head>
      <link rel="stylesheet" href="styles.css">
        <meta charset="utf-8">
        <script type="text/javascript" src="D3/d3.js"></script>
    </head>
    <body>
        <script type="text/javascript">

        // set width and height
        var w = 400;
        var h = 200;
        var barPadding = 3;
        var heightMargin = 250;
        var widthMargin = 30;

        // set title
          d3.select("head").append("title")
            .text("Barchart obesity among children")
          d3.select("body").append("p1")
            .text("This barchart shows obesity rates in %, among girls, as measured by the WHO in 2016.\n")
          d3.select("body").append("p2")
            .text("By Ellemijke Donner (10734198).")


        d3.json("obesitas.json", function(data) {
          var dataset = Object.values(data)[0]

        // get country values
        var country = dataset.map(function(d){
          return d["Country"];
        });

        // get values for boys
        var boy = dataset.map(function (d){
          return d["Boy"];
        });

        // get values for girls
        var girl = dataset.map(function (d){
          return d["Girl"];
        });

        // make the svg
        var svg = d3.select("body").append("svg")
                     .attr("width", w + (2 * widthMargin))
                     .attr("height", h + (2 * heightMargin));

        // make scale
        var xScale = d3.scale.linear()
                      .domain([0, country.length])
                      .range([widthMargin, w + widthMargin]);

        var yScale = d3.scale.linear()
                      .domain([0, 25])
                      .range([25, h]);

        var axisScale = d3.scale.linear()
                          .domain([0, 25])
                          .range([h, 0]);

        var xAxis = d3.svg.axis()
                      .scale(xScale)
                      .orient("bottom")
                      .ticks(girl.length)
                      .tickFormat(function(d, i){
                                return country[i]
                      });

        var yAxis = d3.svg.axis()
                      .scale(axisScale)
                      .orient("left")
                      .ticks(5);


          // create SVG Barchart
          svg.selectAll("rect")
               .data(girl)
               .enter()
               .append("rect")
               .attr("x", function(d, i) {
                 return i * (w / girl.length) + widthMargin;
               })
               .attr("y", function (d){
                 return h + heightMargin - yScale((d));
               })
               .attr("width", w / girl.length - barPadding)
               .attr("height", function(d) {
                 return yScale(d);
               })
               .attr("fill", "pink")


        //   svg.selectAll("text")
          //     .data(girl)
          //     .enter()
          //     .append("text")
          //     .text(function (d) {
          //       return d;
          //     })
            //   .attr("x", function(d, i) {
              //   return i * (w / dataset.length); // +5
    //           })
      //         .attr("y", function (d) {
        //         return h - (d * 4); // + 15
          //     })
            //   .attr("text-anchor", "middle")

            //svg.append("g")
//                .attr("class", "axis")
  //              .attr("transform", "translate(0,"+ (h - padding) + ")")
    //            .call(xAxis);
//
  //          svg.append("g")
    //            .attr("class", "axis")
      //          .attr("transform", "translate(0,"+ (h - padding) + ")")
        //        .call(yAxis);
        // create X axis
            svg.append("g")
                .attr("class","axis")
                .attr("transform", "translate(0," + (h + heightMargin) + ")")
                .call(xAxis)
                .selectAll("text")
                .style("text-anchor", "end")
                .attr("dx", "-.10em")
                .attr("dy", ".70em")
                .attr("transform", "rotate(-65)")
            // create Y axis
            svg.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(" + widthMargin + "," +
                       heightMargin + ")")
                .call(yAxis);
});
        </script>
    </body>
</html>
